AmCharts.bestFitLineProcess=function(e,i){function r(e,i,r){var t=i;if(r.categoryAxis.parseDates===!0){if(void 0!==r.dataDateFormat)var a=AmCharts.stringToDate(e,r.dataDateFormat);else var a=new Date(e);t=a.getTime(),t||(t=e)}return t}function t(e,i){var r=0,t=0,a=0,n=0,d=0,h=0,s=0,o=e.length;if(o!=i.length)throw new Error("The parameters values_x and values_y need to have same size!");if(0===o)return[[],[]];for(var v=0;v<o;v++)h=e[v],s=i[v],r+=h,t+=s,n+=h*h,a+=h*s,d++;for(var l=(d*a-r*t)/(d*n-r*r),u=t/d-l*r/d,f=[],g=[],v=0;v<o;v++)h=e[v],s=h*l+u,f.push(h),g.push(s);return[f,g]}if(void 0!==e.dataProvider&&0!==e.dataProvider.length)for(var a=0;a<e.graphs.length;a++){var n,d,h,s,o,v=e.graphs[a],l=0;if(void 0!==v.bestFitLine){for(var u=[],f=[],g=0;g<e.dataProvider.length;g++){var p=r(e.dataProvider[g][e.categoryField],g,e),F=parseFloat(e.dataProvider[g][v.valueField]);isNaN(F)!==!0&&(u.push(p),f.push(F),void 0===n&&(n=g),l=g,void 0===d&&(d=p),h=p),void 0===s&&(s=p),o=p}var L=t(u,f);if(v.bestFitLine.extend===!0){var P=e.dataProvider.length-1,b=h-d,c=L[1][0],m=L[1][L[1].length-1],T=(m-c)/b;n>0&&(u.unshift(s),f.unshift(c-(d-s)*T),n=0),P>l&&(u.push(o),f.push(m+(o-h)*T),l=P);var L=t(u,f);v.bestFitLine.includeInMinMax=!1}var W=v.bestFitLine;W.valueField=v.valueField+"FitLine",W.trendInited!==!0&&e.graphs.push(W),W.trendInited=!0,e.dataProvider[n][W.valueField]=L[1][0],e.dataProvider[l][W.valueField]=L[1][L[1].length-1],W.hideWithParent===!0&&(void 0===e.graphsWithTrendLines&&(e.graphsWithTrendLines=[]),e.graphsWithTrendLines.push(v),v.hiddenBefore=v.hidden===!0,1===e.graphsWithTrendLines.length&&e.addListener("drawn",function(i){for(var r=0;r<e.graphsWithTrendLines.length;r++){var t=e.graphsWithTrendLines[r];if(t.hidden===t.hiddenBefore)return;t.hiddenBefore=t.hidden,t.hidden&&!t.bestFitLine.hidden?e.hideGraph(t.bestFitLine):!t.hidden&&t.bestFitLine.hidden&&e.showGraph(t.bestFitLine)}}))}i===!0&&e.validateData()}},AmCharts.addInitHandler(function(e){AmCharts.bestFitLineProcess(e,!1)},["serial"]);